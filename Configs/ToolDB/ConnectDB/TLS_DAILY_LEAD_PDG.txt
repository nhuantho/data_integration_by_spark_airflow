SELECT WPOTF.PAWN_ONLINE_WID , WPOTF.FORM_CREATED_DT , WPOTF.HOUR_FROM_CREATED , WPOTF.FORM_ASSET , WPOTF.PROVINCE ,WPOTF.DISTRICT , WPOTF.CALLER_NAME , WPOTF.CALLER_CODE , WPOTF.FIRST_CALL , WPOTF.HOUR_FIRST_CALL , WPOTF.LAST_CALL , WPOTF.HOUR_LAST_CALL , WPOTF.TRANS_FST_DT , WPOTF.TRANS_LST_DT , WAMD.TPK , WAMD.QLKV ,WPOTF.SHOP_NAME , WPOTF.SALER_NAME , WPOTF.SALER_CODE , WPOTF.SHOP_FST_DT , WPOTF.HOUR_SHOP_FST , WPOTF.SHOP_LST_DT , WPOTF.HOUR_SHOP_LST, WPOTF.CAMPAIGN , WPOTF.NHOM_NGUON , WPOTF.NGUON_PHU , WPOTF.PHAN_LOAI_NGUON_PHU , WPOTF.DISBURSE_DT , WPOTF.CONTRACT_NO , WPOTF.PACKGE_CODDE , WPOTF.ASSET , WPOTF.MONEY, WPOTF.STATUS_STR , WPOTF.LST_STR_STATUS_CONTENT , WPOTF.COMMENT1 FROM F88DWH.W_PAWN_ONLINE_TLS_F WPOTF JOIN (SELECT MA_NS, COUNT(1) FROM F88DWH.W_TLS_EMPLOYEE_D WHERE YEAR = 2023 GROUP BY MA_NS) WTED ON (CASE WHEN WPOTF.CALLER_CODE LIKE 0x91%0x93_0x9310x91THEN SUBSTR(CALLER_CODE,1,LENGTH (CALLER_CODE) - 2) WHEN WPOTF.CALLER_CODE LIKE 0x91%0x93_0x93%0x91THEN SUBSTR(CALLER_CODE,1,LENGTH (CALLER_CODE) - 3) ELSE WPOTF.CALLER_CODE END) = WTED.MA_NS LEFT JOIN F88DWH.W_AREA_MANAGER_D WAMD ON WPOTF.SHOP_CURRENT_WID= WAMD.SHOP_ID WHERE TRUNC(WPOTF.TRANS_FST_DT) >= TRUNC(TO_DATE(:DAY1,0x91YYYY-MM-DD0x91),0x91MM0x91) AND TRUNC(WPOTF.TRANS_FST_DT) <= TO_DATE(:DAY1,0x91YYYY-MM-DD0x91)